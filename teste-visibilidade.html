<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Visibilidade dos Blocos</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .field { margin: 10px 0; padding: 10px; border: 1px solid #ddd; }
        .hidden { display: none; }
        select, input { padding: 5px; margin: 5px; }
        button { padding: 8px 12px; background: #007bff; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h1>ğŸ” Teste de Visibilidade dos Blocos</h1>
    
    <div>
        <label>Forma de Pagamento:</label>
        <select id="forma">
            <option value="">Selecione...</option>
            <option value="Ã€ vista">Ã€ Vista</option>
            <option value="CartÃ£o">CartÃ£o</option>
            <option value="Boleto">Boleto</option>
        </select>
        
        <input type="checkbox" id="auto" checked> Auto-cÃ¡lculo
        
        <button onclick="testVisibility()">ğŸ§ª Testar Visibilidade</button>
        <button onclick="runDiagnostic()">ğŸ” DiagnÃ³stico</button>
    </div>
    
    <hr>
    
    <h2>Campos Financeiros</h2>
    
    <div class="field" data-show="avista" id="field-avista">
        <label>ğŸ’° Ã€ Vista:</label>
        <input id="avista" placeholder="R$ 0,00">
        <small>(VisÃ­vel apenas em: Ã€ vista)</small>
    </div>
    
    <div class="field" data-show="boleto" id="field-entrada">
        <label>ğŸ¦ Entrada:</label>
        <input id="entrada" placeholder="R$ 0,00">
        <small>(VisÃ­vel apenas em: Boleto)</small>
    </div>
    
    <div class="field" data-show="cartao,boleto" id="field-nParcelas">
        <label>ğŸ”¢ NÂº Parcelas:</label>
        <input id="nParcelas" placeholder="Ex: 12">
        <small>(VisÃ­vel em: CartÃ£o, Boleto)</small>
    </div>
    
    <div class="field" data-show="cartao,boleto" id="field-parcela">
        <label>ğŸ“‹ Valor Parcela:</label>
        <input id="parcela" placeholder="R$ 0,00">
        <small>(VisÃ­vel em: CartÃ£o, Boleto)</small>
    </div>
    
    <div class="field" data-show="boleto" id="field-diaVenc">
        <label>ğŸ“… Dia Vencimento:</label>
        <input id="diaVenc" placeholder="5, 10, 15...">
        <small>(VisÃ­vel apenas em: Boleto)</small>
    </div>
    
    <div class="field" data-show="boleto" id="field-desconto">
        <label>ğŸ’¸ Desconto:</label>
        <input id="desconto" placeholder="R$ 0,00">
        <small>(VisÃ­vel apenas em: Boleto)</small>
    </div>
    
    <div class="field" id="field-total">
        <label>ğŸ’ Total:</label>
        <input id="total" placeholder="R$ 0,00">
        <small>(Sempre visÃ­vel)</small>
    </div>

    <div id="output" style="margin-top: 20px; padding: 10px; background: #f5f5f5;"></div>

    <script>
        // FunÃ§Ã£o para atualizar visibilidade
        function updateVisibility() {
            const forma = document.getElementById('forma').value;
            const output = document.getElementById('output');
            
            console.log('ğŸ”„ Atualizando visibilidade para:', forma);
            output.innerHTML = `<strong>Forma selecionada:</strong> ${forma}<br><br>`;
            
            // Encontrar todos os elementos com data-show
            const elements = document.querySelectorAll('[data-show]');
            
            elements.forEach(element => {
                const showFor = element.getAttribute('data-show');
                let visible = false;
                
                // Suporta mÃºltiplos valores separados por vÃ­rgula
                const formasPermitidas = showFor.split(',').map(f => f.trim());
                
                if (formasPermitidas.includes('cartao') && forma === 'CartÃ£o') visible = true;
                if (formasPermitidas.includes('boleto') && forma === 'Boleto') visible = true;
                if (formasPermitidas.includes('avista') && forma === 'Ã€ vista') visible = true;
                
                element.style.display = visible ? 'block' : 'none';
                
                const status = visible ? 'âœ… VisÃ­vel' : 'âŒ Oculto';
                output.innerHTML += `<div>${element.id}: ${showFor} â†’ ${status}</div>`;
            });
        }
        
        // FunÃ§Ã£o de teste
        function testVisibility() {
            console.log('ğŸ§ª === TESTE DE VISIBILIDADE ===');
            updateVisibility();
        }
        
        // FunÃ§Ã£o de diagnÃ³stico
        function runDiagnostic() {
            console.log('ğŸ” === DIAGNÃ“STICO COMPLETO ===');
            
            const forma = document.getElementById('forma').value;
            const elements = document.querySelectorAll('[data-show]');
            
            console.log('ğŸ“‹ Forma atual:', forma);
            console.log('ğŸ“Š Elementos com data-show encontrados:', elements.length);
            
            elements.forEach((el, i) => {
                const showFor = el.getAttribute('data-show');
                const isVisible = el.style.display !== 'none';
                console.log(`${i+1}. ${el.id}: data-show="${showFor}", visÃ­vel=${isVisible}`);
            });
        }
        
        // Event listener para mudanÃ§as
        document.getElementById('forma').addEventListener('change', updateVisibility);
        
        // Executar teste inicial
        updateVisibility();
        
        console.log('âœ… Teste de visibilidade carregado');
    </script>
</body>
</html>